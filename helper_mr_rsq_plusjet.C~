{
  gROOT->SetStyle("Plain"); // remove gray background from plots
  //gSystem->Load("libMinuit.so") ;
  //gSystem->Load("$ROOTSYS/lib/libRooFitCore.so") ;
  //gSystem->Load("$ROOTSYS/lib/libRooFitModels.so") ;
  gStyle->SetTitleFontSize(.055);
  //  gStyle->SetLabelSize(.049,"xy");
  gStyle->SetPalette(1);
  gStyle->SetTitleBorderSize(0);
  gStyle->SetTitleX(0.3);
  gStyle->SetTitleW(0.4);

  Int_t min_mr = 225;
  Int_t max_mr = 1000;
  Float_t min_rsq = .03;
  Float_t max_rsq = .22;
  Int_t nbins_mr = 40;
  Int_t nbins_rsq = 40;

  Int_t min_events  = 1;
  Int_t max_events = 100;

  TH2F * hist  = new TH2F("hist" ,"hist", nbins_mr,min_mr,max_mr,nbins_rsq,min_rsq,max_rsq);
  TH2F * hist2 = new TH2F("hist2","hist2",nbins_mr,min_mr,max_mr,nbins_rsq,min_rsq,max_rsq);
  TH1F * hist3 = new TH1F("hist3","hist3",nbins_rsq,min_rsq,max_rsq);
  TH1F * hist4 = new TH1F("hist4","hist4",nbins_rsq,min_rsq,max_rsq);
  TH1F * hist5 = new TH1F("hist5","hist5",nbins_mr,min_mr,max_mr);
  TH1F * hist6 = new TH1F("hist6","hist6",nbins_mr,min_mr,max_mr);

  TH2F * hists_2D[2];
  TH1F * hists_1D[4];

  TCut fullcut = "PFMR>225 && PFR^2>.03 && nMu == 0 && nEle == 0";

  TCanvas c1;

  outTreeGGJ->Draw("PFR^2:PFMR>>hist",fullcut,"colz");
  gStyle->SetOptStat(0);
  hist.GetXaxis().SetTitle("M_{R} [GeV]");
  hist.GetXaxis().SetRange(min_mr,max_mr);
  hist.GetYaxis().SetTitle("R^{2}");
  
  hist.SetTitle("Tight-Tight + Jet");
  hist.SetMinimum(min_events);
  hist.SetMaximum(max_events);
  hist.Draw("colz");
  
  hists_2D[0] = hist;
  c1.SetLogz();

  c1.SaveAs("mr_rsq_ttj.pdf");

  c1.SaveAs("mr_rsq_ttj.C");

  gStyle->SetOptStat(0);
  outTreeFFJ->Draw("PFR^2:PFMR>>hist2",fullcut,"colz");
  gStyle->SetOptStat(0);
  hist2.GetXaxis().SetTitle("M_{R} [GeV]");
  hist2.GetXaxis().SetRange(min_mr,max_mr);
  hist2.GetYaxis().SetTitle("R^{2}");
  hist2.SetTitle("Fake-Fake + Jet");
  hist2.SetMinimum(min_events);
  hist2.SetMaximum(max_events);
  hist2.Draw("colz");
  hists_2D[1] = hist2;


  c1.SetLogz();
  c1.SaveAs("mr_rsq_ffj.pdf");
  c1.SaveAs("mr_rsq_ffj.C");

  outTreeGGJ->Draw("PFR^2>>hist3", fullcut);
  hist3.GetXaxis().SetTitle("R^{2}");
  hist3.GetXaxis().SetRange(0,.3);
  hist3.GetYaxis().SetTitle("N events");
  hist3.SetTitle("R^{2} Tight-Tight + Jet");
  hists_1D[0] = hist3;

  hist3.Draw();
  c1.SetLogy();
  c1.SaveAs("rsq_ttj.pdf");
  c1.SaveAs("rsq_ttj.C");

  outTreeFFJ->Draw("PFR^2>>hist4", fullcut);
  hist4.GetXaxis().SetTitle("R^{2}");
  hist4.GetYaxis().SetTitle("N events");
  hist4.SetTitle("R^{2} Fake-Fake + Jet  ");
  hists_1D[1] = hist4;


  hist4.Draw();
  c1.SetLogy();
  c1.SaveAs("rsq_ffj.pdf");
  c1.SaveAs("rsq_ffj.C");

  outTreeFFJ->Draw("PFMR>>hist5", fullcut);

  hist5.GetXaxis().SetTitle("M_{R} [GeV]");
  hist5.GetYaxis().SetTitle("N events");
  hist5.SetTitle("M_{R} Fake-Fake + Jet");
  hists_1D[2] = hist5;

  hist5.Draw();

  
  c1.SetLogy();
  c1.SaveAs("mr_ffj.pdf");
  c1.SaveAs("mr_ffj.C");

  outTreeGGJ->Draw("PFMR>>hist6", fullcut);
  hist6.GetXaxis().SetTitle("M_{R} [GeV]");
  hist6.GetYaxis().SetTitle("N events");
  hist6.SetTitle("M_{R} Tight-Tight + Jet");
  hists_1D[3] = hist6;


  hist6.Draw();
  c1.SetLogy();
  c1.SaveAs("mr_ttj.pdf");
  c1.SaveAs("mr_ttj.C");


  TFile output("mr_rsq_hists.root","RECREATE");

  for(Int_t ii = 0; ii < 2; ii++) { 
    hists_2D[ii]->Write();
  }

  for(Int_t ii = 0; ii < 4; ii++) { 
    hists_1D[ii]->Write();
  }

  
  output->Write();
  output->Close();
}
